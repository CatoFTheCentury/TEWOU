(()=>{"use strict";var e,t,s,i,r,a,o,n,l,h,c,x;!function(e){class t{static MAXLAYERS=256;static vbuffer;static Rframebuffer;static framebuffer;static renderbuffer;static gl}e.Info=t,e.GL=class extends t{constructor(e,s){super(),t.gl||(t.gl=(()=>{document.getElementById("canvas").setAttribute("width",e),document.getElementById("canvas").setAttribute("height",s);let t=document.querySelector("#canvas").getContext("webgl2",{premultipliedAlpha:!1});return t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t})(),t.framebuffer=t.gl.createFramebuffer(),t.Rframebuffer=t.gl.createFramebuffer(),t.renderbuffer=t.gl.createRenderbuffer(),t.vbuffer=t.gl.createBuffer(),t.gl.bindBuffer(t.gl.ARRAY_BUFFER,t.vbuffer),t.gl.bufferData(t.gl.ARRAY_BUFFER,new Float32Array([1,0,0,0,0,1,1,0,0,1,1,1]),t.gl.STATIC_DRAW),t.gl.clearColor(0,.5,0,0),t.gl.bindFramebuffer(t.gl.READ_FRAMEBUFFER,t.Rframebuffer),t.gl.bindFramebuffer(t.gl.DRAW_FRAMEBUFFER,t.framebuffer),t.gl.bindRenderbuffer(t.gl.RENDERBUFFER,t.renderbuffer),t.gl.renderbufferStorage(t.gl.RENDERBUFFER,t.gl.RGBA8,2e3,2e3),t.gl.framebufferRenderbuffer(t.gl.DRAW_FRAMEBUFFER,t.gl.COLOR_ATTACHMENT0,t.gl.RENDERBUFFER,t.renderbuffer),t.gl.readBuffer(t.gl.COLOR_ATTACHMENT0),t.gl.drawBuffers([t.gl.COLOR_ATTACHMENT0]))}static resizeCanvasToDisplaySize(e,t){t=t||1;const s=e.clientWidth*t|0,i=e.clientHeight*t|0;return(e.width!==s||e.height!==i)&&(e.width=s,e.height=i,!0)}}}(e||(e={})),function(e){class t{static lastTick=0;static currTick=0}class s{static firstTick=0;static delta=16;static refresh(){t.currTick=Date.now(),s.delta=Math.min(t.currTick-t.lastTick,160),t.lastTick=t.currTick}static getTick(){return t.currTick}}e.Delta=s,e.Timeout=class{ms;step=0;end;start;cyclic=!1;deletion=!1;paused=!1;trigName;constructor(e,s,i=!1){this.ms=e,this.trigName=s,this.cyclic=i,this.start=t.currTick,e[0]===1/0?this.end=1/0:this.end=t.currTick+e[0]}reset(){this.start=t.currTick,this.end===1/0||(this.end=t.currTick+this.ms[this.step])}restart(){this.paused=!1,this.reset()}pause(){this.paused=!0}getTimeoutTicks(){return t.currTick-this.start}test(){return this.paused?(this.end===1/0||(this.end+=s.delta),{name:this.trigName,state:"paused"}):this.end<=t.currTick?(this.cyclic&&this.step++,this.step>=this.ms.length&&(this.step=0),this.start=t.currTick,this.end!==1/0&&(this.end=t.currTick+this.ms[this.step]),{name:this.trigName,state:"triggered"}):{name:this.trigName,state:"active"}}}}(t||(t={})),function(e){e[e.none=1]="none",e[e.block=2]="block",e[e.hurt=4]="hurt",e[e.interact=8]="interact",e[e.climbable=16]="climbable",e[e.instakill=32]="instakill",e[e.get=64]="get",e[e.all=127]="all"}(s||(s={})),function(e){e[e.none=1]="none",e[e.player=2]="player",e[e.npc=4]="npc",e[e.grid=8]="grid",e[e.interactable=16]="interactable",e[e.all=31]="all"}(i||(i={})),function(e){class i{static pool=[];triggers=[];timeouts=[];constructor(){i.pool.push(this)}finalize(){}resetmovementvector(){}static refresh(){for(let e=0;e<this.pool.length;e++)i.pool[e].update();for(let e=0;e<this.pool.length;e++)i.pool[e].finalize()}static refreshsome(e){for(let t=0;t<e.length;t++)e[t].update();for(let t=0;t<e.length;t++)e[t].finalize()}static resetallmovements(){for(let e of i.pool)e.resetmovementvector()}update(){this.timeouts=this.timeouts.filter(e=>!e.deletion&&(this.triggers.push(e.test()),!0))}destroy(){i.pool.filter(e=>e!=this)}react(e,t){return!1}}e.Alacrity=i;class r extends i{myFrame;collisions=[];hitbox={x:0,y:0,w:0,h:0};activeeffects=[0,0,0,0];pos={x:0,y:0};flip={flipx:!1,flipy:!1};constructor(e){super(),this.myFrame=e,this.myFrame.rprops.pos=this.pos,this.myFrame.rprops.layer=.5,this.myFrame.rprops.flip=this.flip}destroy(){super.destroy(),this.myFrame.rprops.delete=!0}}e.Embodiment=r,e.Mobility=class extends r{movementvector={x:0,y:0};speed=.2;gravity=new Set;finalize(){let e={x:this.movementvector.x*this.speed*t.Delta.delta,y:this.movementvector.y*this.speed*t.Delta.delta};for(let s of this.gravity)e.x+=s.x*s.strength*t.Delta.delta,e.y+=s.y*s.strength*t.Delta.delta;(e.x<0&&!(this.activeeffects[1]&s.block)||e.x>0&&!(this.activeeffects[3]&s.block))&&(this.pos.x+=e.x),(e.y<0&&!(this.activeeffects[0]&s.block)||e.y>0&&!(this.activeeffects[2]&s.block))&&(this.pos.y+=e.y)}resetmovementvector(){this.movementvector={x:0,y:0}}}}(r||(r={}));class u extends e.Info{static createTexture(t){let s=this.createTexToBlitOn(t.width,t.height);return e.Info.gl.bindTexture(e.Info.gl.TEXTURE_2D,s),e.Info.gl.texImage2D(e.Info.gl.TEXTURE_2D,0,e.Info.gl.RGBA,e.Info.gl.RGBA,e.Info.gl.UNSIGNED_BYTE,t),s}static createSprite(t,s,i){const r=e.Info.gl.createFramebuffer();let a=u.createTexToBlitOn(i.w,i.h);return e.Info.gl.bindFramebuffer(e.Info.gl.FRAMEBUFFER,r),e.Info.gl.framebufferTexture2D(e.Info.gl.FRAMEBUFFER,e.Info.gl.COLOR_ATTACHMENT0,e.Info.gl.TEXTURE_2D,s,0),e.Info.gl.bindTexture(e.Info.gl.TEXTURE_2D,a),e.Info.gl.copyTexSubImage2D(e.Info.gl.TEXTURE_2D,0,0,0,i.x,i.y,i.w,i.h),e.Info.gl.deleteFramebuffer(r),a}static createTexToBlitOn(t,s){const i=e.Info.gl.createTexture();return e.Info.gl.bindTexture(e.Info.gl.TEXTURE_2D,i),e.Info.gl.texImage2D(e.Info.gl.TEXTURE_2D,0,e.Info.gl.RGBA,t,s,0,e.Info.gl.RGBA,e.Info.gl.UNSIGNED_BYTE,null),e.Info.gl.texParameteri(e.Info.gl.TEXTURE_2D,e.Info.gl.TEXTURE_MIN_FILTER,e.Info.gl.NEAREST),e.Info.gl.texParameteri(e.Info.gl.TEXTURE_2D,e.Info.gl.TEXTURE_MAG_FILTER,e.Info.gl.NEAREST),e.Info.gl.texParameteri(e.Info.gl.TEXTURE_2D,e.Info.gl.TEXTURE_WRAP_S,e.Info.gl.CLAMP_TO_EDGE),e.Info.gl.texParameteri(e.Info.gl.TEXTURE_2D,e.Info.gl.TEXTURE_WRAP_T,e.Info.gl.CLAMP_TO_EDGE),i}static nextPowerOfTwo(e){return 2==e||4==e||8==e||16==e||32==e||64==e||128==e||256==e||512==e||1024==e||2048==e?e:e>2048?2048:e<=0?1:(e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,1+(e|=e>>16))}}class d{static parser=new DOMParser;static textures={};static texts={};static sounds={};static imgExts=["png","jpg","gif","jpeg"];static txtExts=["nw","txt","vert","frag","gani","csv"];static sndExts=["wav","mp3"];static audioContext;static placeholder="_assets/blocking.png";static getTexture(e){return d.textures[e]?d.textures[e].t:(console.log("Texture file not found or not loaded : "+e),d.textures[this.placeholder])}static getTextureWidth(e){return d.textures[e]?d.textures[e].w:(console.log("Texture file not found or not loaded : "+e),-1)}static getTextureHeight(e){return d.textures[e]?d.textures[e].h:(console.log("Texture file not found or not loaded : "+e),-1)}static getText(e){return d.texts[e]?d.texts[e]:(console.log("Text file not found or not loaded : "+e),"")}static initAudio(){d.audioContext=new window.AudioContext}static addTexture(e,t,s){d.textures[e]={t,...s}}static async addImage(e){if(!d.textures[e]){let t=new Image;t.src=e,await t.decode().then(()=>{d.textures[e]={t:u.createTexture(t),w:t.width,h:t.height}})}return e}static async addText(e){return d.texts[e]||(d.texts[e]=await fetch(e).then(e=>e.text())),e}static async addSound(e){return d.sounds[e]||await fetch(e).then(e=>e.arrayBuffer()).then(e=>d.audioContext.decodeAudioData(e)).then(t=>{d.sounds[e]=t}).catch(e=>console.error("Error loading audio file:",e)),e}static playSound(e){d.sounds[e]?d.play(d.sounds[e]):d.addSound(e).then(e=>d.play(d.sounds[e]))}static play(e){let t=d.audioContext.createBufferSource();t.buffer=e,t.connect(d.audioContext.destination),t.start()}static async loadAllExtInFolder(e,t){let s=new XMLHttpRequest,i=[];return s.open("GET",e,!1),s.onreadystatechange=function(){if(4===s.readyState&&200===s.status){let r=d.parser.parseFromString(s.responseText,"text/html").getElementsByTagName("a"),a=[];for(let e=0;e<r.length;e++)a.push(r[e].getAttribute("href"));for(let s of a){if(s.trim().length<=0)continue;let r=s.split("."),a=r[r.length-1];a.endsWith("/")||a.startsWith("?")||(t.includes(a)?d.imgExts.includes(a)?i.push(d.addImage(e+s)):d.txtExts.includes(a)?i.push(d.addText(e+s)):d.sndExts.includes(a)?i.push(d.addSound(e+s)):console.log("Incompatible file : "+s):console.log("File is neither "+t.join(" or ")+" : "+s))}}},s.send(),await Promise.all(i),i}}class y extends e.Info{static shaders={};static fallbackShader="normal";static previousShader="";static currShader;static getShader(e=""){let t=y.shaders[e]||y.shaders[y.fallbackShader]||void 0;return void 0===t&&console.log("Shader "+e+" doesn't exist and couldn't find fallback shader "+y.fallbackShader),t}static compileShader(e,t){let s=y.gl.createShader(e);return y.gl.shaderSource(s,t),y.gl.compileShader(s),y.gl.getShaderParameter(s,y.gl.COMPILE_STATUS)?s:(console.debug(y.gl.getShaderInfoLog(s)),y.gl.deleteShader(s),null)}static createProgram(e,t){let s=y.gl.createProgram();return y.gl.attachShader(s,e),y.gl.attachShader(s,t),y.gl.linkProgram(s),y.gl.getProgramParameter(s,y.gl.LINK_STATUS)?s:(console.debug(y.gl.getProgramInfoLog(s)),y.gl.deleteProgram(s),null)}static passShader(e,t){if(null!=e.rprops.shaderID?y.validateShader(e.rprops.shaderID):y.validateShader(this.fallbackShader),null!=y.currShader){for(const e of y.currShader.second)e();for(const s of y.currShader.passes)s(e,t)}}static validateShader(e){y.previousShader!==e&&(y.currShader=y.shaders[e],null!=y.currShader?(y.initShader(y.currShader),y.previousShader=e):(y.currShader=y.shaders[this.fallbackShader]||void 0,null!=y.currShader?y.initShader(y.currShader):console.log("Fallback shader undefined"),y.previousShader=this.fallbackShader))}static initShader(t){e.Info.gl.useProgram(t.program);for(const e of y.currShader.first)e()}}class p extends e.Info{static frm;static refresh(){var e=y.gl;p.frm.compose(),e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT),e.bindTexture(e.TEXTURE_2D,p.frm.texture),y.passShader(p.frm,{w:e.canvas.width,h:e.canvas.height}),e.drawArrays(e.TRIANGLES,0,6)}}!function(t){class s extends e.Info{rprops;texture;file;ready;constructor(){super(),this.rprops={srcrect:void 0,dstrect:{x:0,y:0,w:0,h:0},pos:{x:0,y:0},flip:{flipx:!1,flipy:!1},angle:0,scalex:1,scaley:1,layer:0,hidden:!1,delete:!1}}}t.Renderable=s;class i extends s{constructor(e,t,s,i=void 0){super(),this.file=e,this.rprops.srcrect=t,this.rprops.dstrect=s}compose(){if(this.ready&&(i.gl.deleteTexture(this.texture),this.ready=!1),!this.ready){let t=u.createTexToBlitOn(this.rprops.srcrect.w,this.rprops.srcrect.h);u.gl.bindFramebuffer(u.gl.FRAMEBUFFER,e.Info.framebuffer),u.gl.framebufferTexture2D(u.gl.FRAMEBUFFER,u.gl.COLOR_ATTACHMENT0,u.gl.TEXTURE_2D,d.getTexture(this.file),0),u.gl.bindTexture(u.gl.TEXTURE_2D,t),u.gl.copyTexSubImage2D(u.gl.TEXTURE_2D,0,0,0,this.rprops.srcrect.x,this.rprops.srcrect.y,this.rprops.srcrect.w,this.rprops.srcrect.h),u.gl.bindFramebuffer(u.gl.FRAMEBUFFER,null),this.texture=t}}}t.Image=i;class r extends s{remove;dynamic=!1;bg;mask;viewport;applyBg(){}applyMask(){}compose(){return this.rprops.delete}constructor(){super(),this.viewport={x:0,y:0,w:r.gl.canvas.width,h:r.gl.canvas.height}}static createFocus(e){return{x:e.reduce((e,t)=>Math.min(e,t.rprops.dstrect.x),e[0].rprops.dstrect.x),y:e.reduce((e,t)=>Math.min(e,t.rprops.dstrect.y),e[0].rprops.dstrect.y),w:e.reduce((e,t)=>Math.max(e,t.rprops.dstrect.w+t.rprops.dstrect.x),0),h:e.reduce((e,t)=>Math.max(e,t.rprops.dstrect.h+t.rprops.dstrect.y),0)}}generateComposite(e,t){let s=e.filter(e=>!e?.rprops.hidden);if(s.length>0){s.sort((e,t)=>e.rprops.layer-t.rprops.layer);for(let e=0;e<s.length;e++)s[e].compose();this.rprops.srcrect={x:t.x,y:t.y,w:t.w<=this.rprops.dstrect.w?this.rprops.dstrect.w:t.w,h:t.h<=this.rprops.dstrect.h?this.rprops.dstrect.h:t.h},this.rprops.dstrect={x:this.rprops.pos.x,y:this.rprops.pos.y,w:this.rprops.srcrect.w,h:this.rprops.srcrect.h};let e=a.gl;e.bindFramebuffer(e.FRAMEBUFFER,r.framebuffer),this.texture=u.createTexToBlitOn(this.rprops.dstrect.w,this.rprops.dstrect.h),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0),e.viewport(this.viewport.x,this.viewport.y,this.rprops.dstrect.w,this.rprops.dstrect.h);for(let t=0;t<s.length;t++)y.gl.bindTexture(e.TEXTURE_2D,s[t].texture),y.passShader(s[t],this.rprops.dstrect),e.drawArrays(e.TRIANGLES,0,6);this.ready=!0}else this.ready=!1}}class a extends r{parts;constructor(e){super(),this.parts=e}compose(){if(this.rprops.delete)return this.rprops.delete;if(this.dynamic&&(this.ready&&r.gl.deleteTexture(this.texture),this.ready=!1),!this.ready){let e=a.createFocus(this.parts);this.generateComposite(this.parts,e)}return this.rprops.delete}}t.Snap=a,t.Animation=class extends r{frames;currentFrame=0;constructor(e){super(),this.dynamic=!0,this.frames=e}compose(){return this.rprops.delete||(!this.frames[this.currentFrame].dynamic&&this.frames[this.currentFrame].ready||this.frames[this.currentFrame].compose(),this.texture=this.frames[this.currentFrame].texture,this.rprops=this.frames[this.currentFrame].rprops,this.ready=this.frames[this.currentFrame].ready),this.rprops.delete}},t.Frame=class extends r{frame;camera=void 0;constructor(e,t={w:0,h:0}){super(),this.frame=e,this.dynamic=!0,this.rprops.dstrect.w=t.w,this.rprops.dstrect.h=t.h}compose(){if(void 0===this.frame[0])return console.log("Skipping empty frame..."),!0;if((this.dynamic||this.rprops.delete)&&((this.ready||this.rprops.delete)&&r.gl.deleteTexture(this.texture),this.ready=!1),!this.ready){this.frame=this.frame.filter(e=>null!=e&&!e.compose());let e=this.frame.filter(e=>e.ready),t=a.createFocus(e);this.rprops.dstrect.x=this.rprops.pos.x,this.rprops.dstrect.y=this.rprops.pos.y,void 0!==this.camera&&(this.rprops.dstrect.w=this.camera.viewport.w,this.rprops.dstrect.h=this.camera.viewport.h,this.viewport={x:-this.camera.viewport.x,y:-this.camera.viewport.y,w:this.camera.viewport.w,h:this.camera.viewport.h}),e.length>0&&this.generateComposite(e,t)}return this.rprops.delete}}}(a||(a={}));class m{static init=!1;static keys={};constructor(){m.init||(document.addEventListener("keydown",e=>{e.repeat||(m.keys[e.key]=1)}),document.addEventListener("keyup",e=>{m.keys[e.key]=-1})),m.init=!0}static refresh(){for(let e in m.keys)m.keys[e]=m.keys[e]<0?0:m.keys[e]>0?2:0}}!function(e){let t,s;!function(e){e[e.idle=0]="idle",e[e.walk=1]="walk",e[e.climb=2]="climb",e[e.attack=3]="attack",e[e.jump=4]="jump",e[e.dead=5]="dead",e[e.length=6]="length"}(t||(t={})),function(e){e[e.grayguy=0]="grayguy",e[e.graygirl=1]="graygirl",e[e.greenimp=2]="greenimp",e[e.reddemon=3]="reddemon",e[e.greenzombie=4]="greenzombie",e[e.skull=5]="skull",e[e.ghost=6]="ghost",e[e.redguy=7]="redguy",e[e.redgirl=8]="redgirl",e[e.blueimp=9]="blueimp",e[e.graydemon=10]="graydemon",e[e.redzombie=11]="redzombie",e[e.redskull=12]="redskull",e[e.redghost=13]="redghost",e[e.blueguy=14]="blueguy",e[e.bluegirl=15]="bluegirl",e[e.dwarf=16]="dwarf",e[e.bluedemon=17]="bluedemon",e[e.bluezombie=18]="bluezombie",e[e.yellowskull=19]="yellowskull",e[e.blueghost=20]="blueghost",e[e.length=21]="length"}(s=e.FullChar||(e.FullChar={}));class i{static scorpions={red:0,black:1,green:2,count:3};static fullscorpions=[];constructor(){if(i.fullscorpions.length<=0)for(let e=0;e<i.scorpions.count;e++){let t={x:16*(26+6*e),y:160};i.fullscorpions.push([new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+16,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})]),new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+32,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+48,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+32,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})]),new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+64,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+16,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+80,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])])])}}}e.ScorpionAnimations=i;class r{static fullCharacters=[];static buildCharacter(e){let t={x:16*(26+6*Math.floor(e/7)),y:16*(1+e%7)};return[new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+16,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})]),new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+32,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+48,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+32,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})]),new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+64,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+16,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:t.x+80,y:t.y,w:16,h:16},{x:0,y:0,w:16,h:16})])])]}constructor(){if(0==r.fullCharacters.length){let e={w:3,h:7};for(let t=0;t<e.w;t++)for(let s=0;s<e.h;s++){let e={x:16*(26+6*t),y:16*(1+s)};r.fullCharacters.push([new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:e.x,y:e.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:e.x+16,y:e.y,w:16,h:16},{x:0,y:0,w:16,h:16})]),new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:e.x+32,y:e.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:e.x+48,y:e.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:e.x+32,y:e.y,w:16,h:16},{x:0,y:0,w:16,h:16})]),new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:e.x+64,y:e.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:e.x+16,y:e.y,w:16,h:16},{x:0,y:0,w:16,h:16})])]),new a.Animation([new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:e.x+80,y:e.y,w:16,h:16},{x:0,y:0,w:16,h:16})])])])}}}}e.CharacterAnimations=r}(o||(o={}));class g{static view;static clickables=[];static clicked=[];static touches=[];static init=!1;constructor(){if(!g.init){let e=document.getElementById("canvas");g.view={w:e.clientWidth,h:e.clientHeight};for(let e=0;e<4;e++)g.touches.push({state:0,pos:{x:0,y:0},start:{x:0,y:0},timer:new t.Timeout([1/0],"time")});document.addEventListener("touchstart",e=>{for(let s=0;s<Math.min(e.changedTouches.length,4);s++){g.touches[e.changedTouches[s].identifier]={state:1,pos:{x:e.changedTouches[s].clientX,y:e.changedTouches[s].clientY},start:{x:e.changedTouches[s].clientX,y:e.changedTouches[s].clientY},timer:new t.Timeout([1/0],"time")};for(let t of g.clickables)g.inBounds(g.touches[e.changedTouches[s].identifier].pos.x,g.touches[e.changedTouches[s].identifier].pos.y,t.bounds)&&t.callback()}}),document.addEventListener("touchend",e=>{e.preventDefault();for(let t=0;t<e.changedTouches.length;t++)g.touches[e.changedTouches[t].identifier].state=-1;g.clicked=[]}),document.addEventListener("touchmove",e=>{e.preventDefault();for(let t=0;t<e.changedTouches.length;t++)g.touches[e.changedTouches[t].identifier].pos={x:e.changedTouches[t].clientX,y:e.changedTouches[t].clientY}})}g.init=!0}static refresh(){for(let e in g.touches)g.touches[e].state=g.touches[e].state<0?0:g.touches[e].state>0?2:0}static addButton(e,t,s){g.clickables.push({name:e,bounds:t,callback:s})}static inBounds(e,t,s){return e>s.x&&e<s.x+s.w&&t>s.y&&t<s.y+s.h}}!function(e){let s;!function(e){e[e.idle=0]="idle",e[e.walk=1]="walk",e[e.climb=2]="climb",e[e.attack=3]="attack",e[e.jump=4]="jump",e[e.dead=5]="dead",e[e.count=6]="count"}(s=e.AniSt||(e.AniSt={}));class i extends r.Mobility{state=s.idle;myCamera;anims;changeframe=new t.Timeout([200],"changeframe");currentAnim;normalgravity={strength:.05,x:0,y:1};constructor(e){super(e),this.changeframe.paused=!0,this.timeouts.push(this.changeframe)}}e.Incarnated=i;class a extends i{}e.Fauna=a,e.Player=class extends a{allstates=(1<<s.count)-1}}(n||(n={}));class f{static pool=[];constructor(e=!1){e?f.pool.unshift(this):f.pool.push(this)}static refresh(){for(let e=0;e<this.pool.length;e++)f.pool[e].refresh()}}class w extends f{static collisionpool=[];constructor(){super()}refresh(){w.collisionpool=w.collisionpool.filter(e=>!e.deleteMe);let e=w.collisionpool.filter(e=>null!=e.self||null==e.self);for(let t of e)t.self&&(t.self.activeeffects=[s.none,s.none,s.none,s.none]);e.forEach(t=>{let s=new Set(e.filter(e=>e.from&t.to&&e.self).map(e=>e.self));t.self&&s.delete(t.self),t.update(s)})}addCollisionTo(e,t){return w.collisionpool.push(t),null!=e&&(e.collisions.push(t),t.self=e),t}}class b{deleteMe=!1;from;to;type;self;offY;offX;width;height;ogBounds={x:0,y:0,w:0,h:0};padding={x:1,y:1};constructor(e,t,s){this.from=e,this.to=t,this.type=s}update(e){for(let t of e)this.intersect(t)}static inBounds(e,t,s){return e>s.x&&e<s.x+s.w&&t>s.y&&t<s.y+s.h}computeCollidePoints(e,t={x:1,y:1},s={w:1,h:1},i=0){let r=[[Math.max(0,Math.floor((e.x+2*t.x)/s.w))>>>i,Math.max(0,Math.floor(e.x/s.w))>>>i,Math.max(0,Math.floor((e.x+e.w-2*t.x)/s.w))>>>i,Math.max(0,Math.floor((e.x+e.w)/s.w))>>>i],[Math.max(0,Math.floor((e.y+2*t.y)/s.h)),Math.max(0,Math.floor(e.y/s.h)),Math.max(0,Math.floor((e.y+e.h-2*t.y)/s.h)),Math.max(0,Math.floor((e.y+e.h)/s.h))]];return[[[r[0][0],r[0][2]],[r[1][1],r[1][1]]],[[r[0][1],r[0][1]],[r[1][0],r[1][2]]],[[r[0][0],r[0][2]],[r[1][3],r[1][3]]],[[r[0][3],r[0][3]],[r[1][0],r[1][2]]]]}}class T extends b{constructor(e,t,s,i){super(t,s,i),this.self=e,this.padding={x:8,y:8}}intersect(e){const t={x:e.pos.x+e.hitbox.x,y:e.pos.y+e.hitbox.y,w:e.hitbox.w,h:e.hitbox.h},i=(this.computeCollidePoints(t,this.padding),this.self.pos.x+this.self.hitbox.x),r=this.self.pos.y+this.self.hitbox.y,a=this.self.hitbox.w,o=this.self.hitbox.h;let n=[s.none,s.none,s.none,s.none];(t.x>i&&t.x+this.padding.x<i+a||t.x+t.w-this.padding.x>i&&t.x+t.w<i+a)&&(n[0]|=r+o-t.y>0&&t.y>r?this.type:s.none,n[2]|=r-(t.y+t.h)<0&&t.y+t.h<r+o?this.type:s.none),(t.y>r&&t.y+this.padding.y<r+o||t.y+t.w-this.padding.y>r&&t.y+t.w<r+o)&&(n[1]|=i+a-t.x>0&&t.x>i?this.type:s.none,n[3]|=i-(t.x+t.w)<0&&t.x+t.w<i+a?this.type:s.none);for(let t=0;t<4;t++)e.activeeffects[t]|=n[t]}static checkBounds(e,t){return b.inBounds(e[0][0],e[1][0],t)||b.inBounds(e[0][1],e[1][1],t)}}!function(e){e[e.idle=0]="idle",e[e.walk=1]="walk",e[e.climb=2]="climb",e[e.attack=3]="attack",e[e.jump=4]="jump",e[e.dead=5]="dead"}(l||(l={}));class A extends n.Player{jumpend;normalgravity={strength:.05,x:0,y:1};jumpgravity={strength:.1,x:0,y:-1};lifetime=new t.Timeout([1/0],"lifetime");isghost=!1;stoptimer=0;timer;uielt;usestouch=!1;inventory={keys:0};constructor(){let e=o.CharacterAnimations.fullCharacters[o.FullChar.skull];super(new a.Frame([e[l.idle].frames[0]])),this.anims=e,this.currentAnim=e[l.idle],this.changeframe=new t.Timeout([150],"changeframe"),this.changeframe.paused=!0,this.timeouts.push(this.changeframe),this.jumpend=new t.Timeout([700],"jumpend"),this.jumpend.paused=!0,this.timeouts.push(this.jumpend),w.collisionpool.push(new T(this,i.player,i.grid|i.npc|i.interactable,s.block)),this.gravity.add(this.normalgravity),this.speed=.075,this.hitbox={x:1,y:2,w:14,h:14},this.flip.flipx=!1,this.pos.x=168,this.pos.y=200}update(){if(super.update(),this.timer||(this.uielt.style.textAlign="left",this.uielt.style.background="red",this.timer=new t.Timeout([1/0],"timer")),0==this.stoptimer){let e=Math.round(this.timer.getTimeoutTicks()/100)/10;this.uielt.innerHTML=e+(e%1==0?".0":"")}this.lifetime.getTimeoutTicks()>500&&this.state==l.walk&&!this.isghost?(d.playSound("_assets/demon/footstep.wav"),this.lifetime.reset()):this.lifetime.getTimeoutTicks()>1e3&&this.state==l.walk&&(d.playSound("_assets/demon/hoverghost.wav"),this.lifetime.reset()),this.state==l.jump&&this.activeeffects[0]&s.block&&this.stopjump(),this.handleKeys(),this.handleTriggers(),this.handleTouch()}react(e,t){switch(e){case"healthup":break;case"becomeghost":this.anims=o.CharacterAnimations.fullCharacters[o.FullChar.ghost],this.isghost=!0;break;case"getkey":this.inventory.keys+=t[0];break;case"usekey":if(this.inventory.keys>0)return d.playSound("_assets/demon/unlock.wav"),this.inventory.keys--,t[0].myCollision.deleteMe=!0,t[0].destroy(),!0;break;case"stoptimer":this.stoptimer=Math.round(this.timer.getTimeoutTicks()/100)/10,this.uielt.innerHTML=this.stoptimer+(this.stoptimer%1==0?".0":""),this.uielt.style.background="green"}return!1}handleTouch(){let e=0;for(let t of g.touches)void 0!==t&&void 0!==t.state&&t.state>0&&e++;if(e>0&&(this.usestouch=!0),this.usestouch)for(let t=0;t<g.touches.length;t++){let i=g.touches[t];if(void 0!==i)switch(i.state){case-1:i.timer.getTimeoutTicks()<500&&i.start.y-i.pos.y>20&&this.activeeffects[2]&s.block&&this.state!=l.jump&&(100*Math.random()>50?d.playSound("_assets/demon/boing1.wav"):d.playSound("_assets/demon/boing2.wav"),this.gravity.add(this.jumpgravity),this.jumpend.reset(),this.jumpend.paused=!1,this.state=l.jump,this.myFrame.frame=[this.anims[this.state]]);break;case 0:0==e&&this.state!=l.jump&&(this.state=l.idle,this.myFrame.frame=[this.anims[this.state]],this.changeframe.paused=!0);break;case 1:this.changeframe.paused=!1;break;case 2:if(0===t||1==e){let e=this.myCamera.worldtoscreen(this);this.movementvector={x:Math.min(3,2/(g.view.w/i.pos.x)-8/(g.view.w/e.x)),y:0},this.flip.flipx=!(this.movementvector.x>0),this.state=l.walk,this.myFrame.frame=[this.anims[this.state]]}this.currentAnim=this.anims[this.state]}}}handleKeys(){for(let e in m.keys)switch(e){case"ArrowUp":m.keys.ArrowUp;break;case"ArrowLeft":switch(m.keys.ArrowLeft){case-1:this.state!=l.jump&&(this.state=l.idle),this.state=l.idle,this.currentAnim.currentFrame=0,this.myFrame.frame=[this.anims[this.state]],this.changeframe.paused=!0;case 0:break;case 1:this.state!=l.jump&&(this.state=l.walk),this.flip.flipx=!0,this.myFrame.frame=[this.anims[this.state]],this.currentAnim=this.anims[this.state],this.changeframe.paused=!1;case 2:this.movementvector.x=-1}break;case"ArrowDown":m.keys.ArrowDown;break;case"ArrowRight":switch(m.keys.ArrowRight){case-1:this.state!=l.jump&&(this.state=l.idle),this.currentAnim.currentFrame=0,this.myFrame.frame=[this.anims[this.state]],this.changeframe.paused=!0;case 0:break;case 2:case 1:this.state!=l.jump&&(this.state=l.walk),this.flip.flipx=!1,this.myFrame.frame=[this.anims[this.state]],this.currentAnim=this.anims[this.state],this.changeframe.paused=!1,this.movementvector.x=1}break;case" ":switch(m.keys[" "]){case-1:case 0:case 2:break;case 1:this.activeeffects[2]&s.block&&this.state!=l.jump&&(100*Math.random()>50?d.playSound("_assets/demon/boing1.wav"):d.playSound("_assets/demon/boing2.wav"),this.gravity.add(this.jumpgravity),this.jumpend.reset(),this.jumpend.paused=!1,this.state=l.jump,this.myFrame.frame=[this.anims[this.state]])}}}handleTriggers(){for(;this.triggers.length>0;){let e=this.triggers.pop()||{name:"notrigger"};switch(e.name){case"changeframe":"triggered"===e.state&&(this.currentAnim.currentFrame=(this.currentAnim.currentFrame+1)%this.currentAnim.frames.length);break;case"jumpend":"triggered"===e.state&&this.stopjump();break;case"healthup":console.log("Health up by"+e.state)}}}stopjump(){this.gravity.delete(this.jumpgravity),this.jumpend.paused=!0,this.state=l.idle,this.myFrame.frame=[this.anims[this.state]]}}class k{static loadCSV(e){return{tileYX:e.split("\n").filter(e=>""!=e).map(e=>e.split(",").map(e=>Number(e)))}}static async loadIni(e){let t,s,i,r,a=[],o="",n=[];const l=d.getText(await d.addText(e)).split("\n");for(let e=0;e<l.length;e++){const h=l[e].split(" ");switch(h[0]){case"TILESET":const e=h[1].split(":");switch(e[0]){case"SQUARE":i={w:Number(e[1]),h:Number(e[1])};break;case"FILE":t=d.getTexture(await d.addImage(e[1])),s=d.getTextureWidth(e[1])}break;case"PLAYGROUND":r=Number(h[1]);break;case"CSV":let l=h[1].split(":");const c=d.getText(await d.addText(l[1]));a[Number(l[0])]={tileYX:c.split("\n").filter(e=>""!=e).map(e=>e.split(",").map(e=>Number(e)))};break;case"NPCS":o=d.getText(await d.addText(h[1]));break;case"COLLISION":const x=d.getText(await d.addText(h[1])).split("\n");let u=[];for(let e of x)u.push(e.split(",").map(e=>!(Number(e)<0)));n=u}}return{tiles:a,npcs:o,collisions:n,tileset:t,tilesetwidth:s,square:i,playLayer:r,grid:{w:a[0].tileYX[0].length,h:a[0].tileYX.length}}}}class v extends e.Info{static blit(e,t){let s=-1;return e.tiles.map(i=>{s++,v.gl.createFramebuffer(),v.gl.bindFramebuffer(v.gl.FRAMEBUFFER,v.framebuffer);const r=e.square.w*i.tileYX[0].length,o=e.square.h*i.tileYX.length,n=e.tilesetwidth/e.square.w;let l=u.createTexToBlitOn(r,o);v.gl.framebufferTexture2D(v.gl.FRAMEBUFFER,v.gl.COLOR_ATTACHMENT0,v.gl.TEXTURE_2D,e.tileset,0),v.gl.bindTexture(v.gl.TEXTURE_2D,l);for(let t=0;t<i.tileYX.length;t++)for(let s=0;s<i.tileYX[t].length;s++)v.gl.copyTexSubImage2D(v.gl.TEXTURE_2D,0,s*e.square.w,t*e.square.h,i.tileYX[t][s]%n*e.square.w,Math.floor(i.tileYX[t][s]/n)*e.square.h,e.square.w,e.square.h);d.addTexture(t+s,l,{w:r,h:o});let h=new a.Image(t+s,{x:0,y:0,w:r,h:o},{x:0,y:0,w:r,h:o}),c=new a.Snap([h]);return c.rprops.layer=s-e.playLayer,c})}}class E extends f{viewport;bounds;actor;constructor(e,t,s){super(),this.actor=e,this.viewport={x:0,y:0,w:t.w,h:t.h},this.bounds=s}refresh(){this.viewport.x=this.actor.pos.x-this.viewport.w/2+this.actor.hitbox.w/2+this.actor.hitbox.x>this.bounds.x?this.actor.pos.x+this.viewport.w/2+this.actor.hitbox.w/2+this.actor.hitbox.x>this.bounds.w?this.bounds.w-this.viewport.w:Math.floor(this.actor.pos.x-this.viewport.w/2+this.actor.hitbox.w/2+this.actor.hitbox.x):this.bounds.x,this.viewport.y=this.actor.pos.y-this.viewport.h/2+this.actor.hitbox.h/2+this.actor.hitbox.y>this.bounds.y?this.actor.pos.y+this.viewport.h/2+this.actor.hitbox.h/2+this.actor.hitbox.y>this.bounds.h?this.bounds.h-this.viewport.h:Math.floor(this.actor.pos.y-this.viewport.h/2+this.actor.hitbox.h/2+this.actor.hitbox.y):this.bounds.y}worldtoscreen(e){return{x:e.pos.x-this.viewport.x,y:e.pos.y-this.viewport.y}}}class _ extends b{padding={x:2,y:2};resolution=16;walls=[];static sizeBit=5;static bitSize=1<<this.sizeBit;ylimit;xlimit;constructor(e,t,s,r){super(i.grid,s,r),this.ylimit=e.length;let a=e[0].length;this.xlimit=a>>_.sizeBit;let o=e.flat(1/0),n=0;this.resolution=t;for(let e=0;e<o.length;e+=a){this.walls.push(Array());for(let t=0;t<a;t+=_.bitSize){let s=0;for(let i=0;i<_.bitSize&&!(t+i>=a);i++)1==o[e+t+i]&&(s|=1<<i);this.walls[n].push(s)}n+=1}}againstGrid(e,t,s){let i=e,r=t;if(r>=this.ylimit||r<0)return!1;let a=1<<Math.floor(s/this.resolution)%_.bitSize;return!(i>=this.xlimit||i<0)&&0!=(this.walls[r][i]&a)}testWall(e){return this.againstGrid(Math.floor(e.x/this.resolution)>>>_.sizeBit,Math.floor(e.y/this.resolution),e.x)}intersect(e){const t=this.computeCollidePoints({x:e.pos.x+e.hitbox.x,y:e.pos.y+e.hitbox.y,w:e.hitbox.w,h:e.hitbox.h},this.padding,{w:this.resolution,h:this.resolution},_.sizeBit);this.checkCollisionDirection(e,0,t[0][0][0],t[0][1][0],e.pos.x+e.hitbox.x+2*this.padding.x,t[0][0][1],t[0][1][1],e.pos.x+e.hitbox.x+e.hitbox.w-2*this.padding.x),this.checkCollisionDirection(e,1,t[1][0][0],t[1][1][0],e.pos.x+e.hitbox.x,t[1][0][1],t[1][1][1],e.pos.x+e.hitbox.x),this.checkCollisionDirection(e,2,t[2][0][0],t[2][1][0],e.pos.x+e.hitbox.x+2*this.padding.x,t[2][0][1],t[2][1][1],e.pos.x+e.hitbox.x+e.hitbox.w-2*this.padding.x),this.checkCollisionDirection(e,3,t[3][0][0],t[3][1][0],e.pos.x+e.hitbox.x+e.hitbox.w-this.padding.x,t[3][0][1],t[3][1][1],e.pos.x+e.hitbox.x+e.hitbox.w-this.padding.x)}checkCollisionDirection(e,t,i,r,a,o,n,l){const h=this.againstGrid(i,r,a),c=this.againstGrid(o,n,l);e.activeeffects[t]|=h||c?this.type:s.none}}class S extends r.Embodiment{static index=0;static foods={fruit:{apple:{shiny:{x:26,y:15},red:{x:26,y:16},gold:{x:26,y:17},green:{x:26,y:18}},pear:{brown:{x:27,y:15},green:{x:27,y:16},yellow:{x:27,y:17},orange:{x:27,y:18}},citrus:{grapefruit:{brown:{x:28,y:15},yellow:{x:28,y:16},orange:{x:28,y:17}},lemon:{x:29,y:15},lime:{x:29,y:16}},cherries:{red:{x:30,y:15},dark:{x:30,y:16}},melon:{pink:{x:34,y:15},yellow:{x:34,y:16},green:{x:34,y:16}},banana:{x:41,y:15}},veggie:{carrot:{orange:{x:31,y:15},gray:{x:31,y:16},yellow:{x:31,y:17}},radish:{x:32,y:15},turnip:{beet:{x:33,y:15},bad:{x:33,y:16},good:{x:33,y:17}},pepper:{red:{x:35,y:15},yellow:{x:35,y:16},green:{x:35,y:17},dark:{x:35,y:18}},brocolli:{green:{x:36,y:15},brown:{x:37,y:16}},cauliflower:{x:37,y:15},bellpepper:{red:{x:38,y:15},yellow:{x:38,y:16},green:{x:38,y:17}},cucumber:{green:{x:39,y:15},yellow:{x:39,y:16},white:{x:39,y:17}},mushroom:{white:{x:40,y:15},brown:{x:40,y:16}}},sandwich:{bread:{tomato:{x:26,y:19},cheese:{x:26,y:20}},burger:{tomato:{x:27,y:19},cheese:{x:27,y:20},chicken:{x:27,y:21}},hotdog:{ketchup:{x:28,y:19},meat:{x:28,y:20},mustard:{x:28,y:21}}},meat:{chicken:{x:29,y:19},beef:{x:29,y:19},pork:{x:29,y:19}},prepared:{can:{x:30,y:19},catfood:{x:30,y:20},dogfood:{x:30,y:21},ramen:{green:{x:31,y:19},red:{x:31,y:20},yellow:{x:31,y:21}}},cheese:{swiss:{x:32,y:19},brie:{x:32,y:20}},sweets:{icecream:{vanilla:{x:26,y:22},strawberry:{x:26,y:23},chocolate:{x:26,y:24}},lollipop:{strawberry:{x:27,y:22},lemon:{x:27,y:23},greenapple:{x:27,y:24}},candy:{blueberry:{x:28,y:22},gray:{x:28,y:23},toffee:{x:28,y:24}},chocolate:{milk:{x:29,y:22},white:{x:29,y:23},dark:{x:29,y:24}},rizzle:{black:{x:30,y:22},red:{x:30,y:23},blue:{x:30,y:24}}},drinks:{soda:{red:{x:26,y:25},blue:{x:26,y:26},yellow:{x:26,y:27},green:{x:26,y:28}},tea:{white:{x:27,y:25},brown:{x:27,y:26},blue:{x:27,y:27},green:{x:27,y:28}},coffee:{white:{x:28,y:25},brown:{x:28,y:26},red:{x:28,y:27},blue:{x:28,y:28}},wine:{white:{x:29,y:25},rose:{x:29,y:26},red:{x:29,y:27},dark:{x:29,y:28}},champagne:{white:{x:30,y:25},yellow:{x:30,y:26},rose:{x:30,y:27},red:{x:30,y:28}},martini:{x:31,y:25},absynthe:{x:31,y:26},orangedrink:{x:31,y:27},umbrellabrink:{x:31,y:28},beer:{white:{x:32,y:25},brown:{x:32,y:26},red:{x:32,y:27},dark:{x:32,y:28}},cup:{white:{x:33,y:25},brown:{x:33,y:26},red:{x:33,y:27}}}};static heals={palegray:{potions:{small:{x:26,y:33},medium:{x:26,y:34},big:{x:26,y:35},huge:{x:26,y:36}},orbs:{small:{x:26,y:37},medium:{x:26,y:38},big:{x:26,y:39},huge:{x:26,y:40}}},darkgray:{potions:{small:{x:27,y:33},medium:{x:27,y:34},big:{x:27,y:35},huge:{x:27,y:36}},orbs:{small:{x:27,y:37},medium:{x:27,y:38},big:{x:27,y:39},huge:{x:27,y:40}}},black:{potions:{small:{x:28,y:33},medium:{x:28,y:34},big:{x:28,y:35},huge:{x:28,y:36}},orbs:{small:{x:28,y:37},medium:{x:28,y:38},big:{x:28,y:39},huge:{x:28,y:40}}},pink:{potions:{small:{x:29,y:33},medium:{x:29,y:34},big:{x:29,y:35},huge:{x:29,y:36}},orbs:{small:{x:29,y:37},medium:{x:29,y:38},big:{x:29,y:39},huge:{x:29,y:40}}},red:{potions:{small:{x:30,y:33},medium:{x:30,y:34},big:{x:30,y:35},huge:{x:30,y:36}},orbs:{small:{x:30,y:37},medium:{x:30,y:38},big:{x:30,y:39},huge:{x:30,y:40}}},blood:{potions:{small:{x:31,y:33},medium:{x:31,y:34},big:{x:31,y:35},huge:{x:31,y:36}},orbs:{small:{x:31,y:37},medium:{x:31,y:38},big:{x:31,y:39},huge:{x:31,y:40}}},orange:{potions:{small:{x:32,y:33},medium:{x:32,y:34},big:{x:32,y:35},huge:{x:32,y:36}},orbs:{small:{x:32,y:37},medium:{x:32,y:38},big:{x:32,y:39},huge:{x:32,y:40}}},ocre:{potions:{small:{x:33,y:33},medium:{x:33,y:34},big:{x:33,y:35},huge:{x:33,y:36}},orbs:{small:{x:33,y:37},medium:{x:33,y:38},big:{x:33,y:39},huge:{x:33,y:40}}},brown:{potions:{small:{x:34,y:33},medium:{x:34,y:34},big:{x:34,y:35},huge:{x:34,y:36}},orbs:{small:{x:34,y:37},medium:{x:34,y:38},big:{x:34,y:39},huge:{x:34,y:40}}},chartreuse:{potions:{small:{x:35,y:33},medium:{x:35,y:34},big:{x:35,y:35},huge:{x:35,y:36}},orbs:{small:{x:35,y:37},medium:{x:35,y:38},big:{x:35,y:39},huge:{x:35,y:40}}},green:{potions:{small:{x:36,y:33},medium:{x:36,y:34},big:{x:36,y:35},huge:{x:36,y:36}},orbs:{small:{x:36,y:37},medium:{x:36,y:38},big:{x:36,y:39},huge:{x:36,y:40}}},forest:{potions:{small:{x:37,y:33},medium:{x:37,y:34},big:{x:37,y:35},huge:{x:37,y:36}},orbs:{small:{x:37,y:37},medium:{x:37,y:38},big:{x:37,y:39},huge:{x:37,y:40}}},babyblue:{potions:{small:{x:38,y:33},medium:{x:38,y:34},big:{x:38,y:35},huge:{x:38,y:36}},orbs:{small:{x:38,y:37},medium:{x:38,y:38},big:{x:38,y:39},huge:{x:38,y:40}}},blue:{potions:{small:{x:39,y:33},medium:{x:39,y:34},big:{x:39,y:35},huge:{x:39,y:36}},orbs:{small:{x:39,y:37},medium:{x:39,y:38},big:{x:39,y:39},huge:{x:39,y:40}}},navy:{potions:{small:{x:40,y:33},medium:{x:40,y:34},big:{x:40,y:35},huge:{x:40,y:36}},orbs:{small:{x:40,y:37},medium:{x:40,y:38},big:{x:40,y:39},huge:{x:40,y:40}}},white:{potions:{small:{x:41,y:33},medium:{x:41,y:34},big:{x:41,y:35},huge:{x:41,y:36}},orbs:{small:{x:41,y:37},medium:{x:41,y:38},big:{x:41,y:39},huge:{x:41,y:40}}},antiquewhite:{potions:{small:{x:42,y:33},medium:{x:42,y:34},big:{x:42,y:35},huge:{x:42,y:36}},orbs:{small:{x:42,y:37},medium:{x:42,y:38},big:{x:42,y:39},huge:{x:42,y:40}}},skull:{orbs:{small:{x:43,y:33},medium:{x:43,y:34},big:{x:43,y:35},huge:{x:43,y:36}}}};static explosizes={bomb:{1:{x:26,y:41},2:{x:27,y:41},3:{x:28,y:41}},tnt:{1:{x:29,y:41},2:{x:30,y:41},3:{x:31,y:41}}};static light={candle:{x:26,y:42},match:{x:27,y:42},lamp:{x:28,y:42},flashlight:{x:29,y:42}};static chests={firstaid:{closed:{white:{x:29,y:43},blue:{x:30,y:43},orange:{x:31,y:43}},open:{white:{x:29,y:44},blue:{x:30,y:44},orange:{x:31,y:44}}},treasure:{closed:{wood:{x:26,y:43},iron:{x:27,y:43},gold:{x:28,y:43}},open:{wood:{x:26,y:44},iron:{x:27,y:44},gold:{x:28,y:44}}}};static locks={keyhole:{gold:{x:26,y:46},iron:{x:27,y:46},rust:{x:28,y:46}},key:{gold:{x:26,y:45},iron:{x:27,y:45},rust:{x:28,y:45}}};static relics={coin:{iron:{x:26,y:47},bronze:{x:27,y:47},silver:{x:28,y:47},gold:{x:29,y:47},platinum:{x:30,y:47}},coins:{iron:{x:26,y:48},bronze:{x:27,y:48},silver:{x:28,y:48},gold:{x:29,y:48},platinum:{x:30,y:48}},bullion:{iron:{x:26,y:50},bronze:{x:27,y:50},silver:{x:28,y:50},gold:{x:29,y:50},platinum:{x:30,y:50}},cross:{iron:{x:26,y:51},bronze:{x:27,y:51},silver:{x:28,y:51},gold:{x:29,y:51},platinum:{x:30,y:51}},orb:{obsidian:{x:31,y:48},emerald:{x:32,y:48},sapphire:{x:33,y:48},ruby:{x:34,y:48},quartz:{x:35,y:48}},square:{obsidian:{x:31,y:49},emerald:{x:32,y:49},sapphire:{x:33,y:49},ruby:{x:34,y:49},quartz:{x:35,y:49}},rupee:{obsidian:{x:31,y:50},emerald:{x:32,y:50},sapphire:{x:33,y:50},ruby:{x:34,y:50},quartz:{x:35,y:50}},diamond:{obsidian:{x:31,y:51},emerald:{x:32,y:51},sapphire:{x:33,y:51},ruby:{x:34,y:51},quartz:{x:35,y:51}},ore:{iron:{x:26,y:49},bronze:{x:27,y:49},silver:{x:28,y:49},gold:{x:29,y:49},platinum:{x:30,y:49},obsidian:{x:31,y:47},emerald:{x:32,y:47},sapphire:{x:33,y:47},ruby:{x:34,y:47},quartz:{x:35,y:47}},idol:{iron:{x:26,y:52},bronze:{x:27,y:52},silver:{x:28,y:52},gold:{x:29,y:52},platinum:{x:30,y:52},obsidian:{x:31,y:52},emerald:{x:32,y:52},sapphire:{x:33,y:52},ruby:{x:34,y:52},quartz:{x:35,y:52}},skull:{iron:{x:26,y:53},bronze:{x:27,y:53},silver:{x:28,y:53},gold:{x:29,y:53},platinum:{x:30,y:53},obsidian:{x:31,y:53},emerald:{x:32,y:53},sapphire:{x:33,y:53},ruby:{x:34,y:53},quartz:{x:35,y:53},skull:{x:36,y:53}}};constructor(e,t){let s=new a.Snap([new a.Image("_assets/demon/tileset_16x16_5A5268.png",{x:16*e.x,y:16*e.y,w:16,h:16},{x:0,y:0,w:16,h:16})]);super(new a.Frame([s])),this.pos.x=t.x,this.pos.y=t.y}}class F extends b{hitbox;owner;call;constructor(e,t,s,i,r,a){super(e,t,s),this.owner=i,this.hitbox=r,this.call=a}intersect(e){let t=this.owner.pos.x+this.hitbox.x,s=this.owner.pos.y+this.hitbox.y,i=this.hitbox.w,r=this.hitbox.h,a=e.pos.x+e.hitbox.x,o=e.pos.y+e.hitbox.y,n=e.hitbox.w,l=e.hitbox.h;t<a+n&&t+i>a&&s<o+l&&s+r>o&&(this.deleteMe=this.call(this.owner,e))}}class I extends S{static index=2680;constructor(e){super(S.relics.skull.skull,e),this.hitbox={x:0,y:0,w:16,h:16},w.collisionpool.push(new T(this,i.npc,i.player,s.block)),w.collisionpool.push(new F(i.interactable,i.player,s.interact,this,{x:0,y:0,w:16,h:16},this.hurt))}hurt(e,t){return t.react("becomeghost",[]),!1}}class R extends S{static index=2326;myCollision;constructor(e){super(S.locks.keyhole.gold,e),this.hitbox={x:0,y:0,w:16,h:16},this.myCollision=new T(this,i.npc,i.player,s.block),w.collisionpool.push(this.myCollision),w.collisionpool.push(new F(i.interactable,i.player,s.interact,this,{x:0,y:0,w:16,h:16},this.usekey))}usekey(e,t){return t.react("usekey",[e])}}class M extends S{static index=2276;constructor(e){super(S.locks.key.gold,e),w.collisionpool.push(new F(i.interactable,i.player,s.interact,this,{x:0,y:0,w:16,h:16},this.get))}get(e,t){return d.playSound("_assets/demon/key.wav"),t.react("getkey",[1]),e.destroy(),!0}}class C extends S{static index=2635;constructor(e){super(S.relics.idol.silver,e),w.collisionpool.push(new F(i.interactable,i.player,s.interact,this,{x:0,y:0,w:16,h:16},this.grab))}grab(e,t){return d.playSound("_assets/demon/finish.mp3"),t.react("stoptimer",[1]),e.destroy(),!0}}class L extends S{static index=791;constructor(e){super(S.foods.fruit.banana,e),w.collisionpool.push(new F(i.interactable,i.player,s.interact,this,{x:0,y:0,w:16,h:16},this.grab))}grab(e,t){return d.playSound("_assets/demon/grab.wav"),t.react("healthup",[1]),e.destroy(),!0}}!function(e){e[e.stay=0]="stay",e[e.wander=1]="wander",e[e.panic=2]="panic",e[e.rush=3]="rush"}(h||(h={})),function(e){e[e.left=1]="left",e[e.right=3]="right"}(c||(c={}));class D extends n.Fauna{allstates=(1<<n.AniSt.count)-1^1<<n.AniSt.climb;static index=540;dir;jumpgravity={strength:.1,x:0,y:-1};actiontimeouts=[new t.Timeout([200],"stay"),new t.Timeout([300],"wander"),new t.Timeout([1/0],"panic"),new t.Timeout([400],"rush")];awarenessbounds={x:-30,y:-20,w:90,h:75};constructor(e){new o.ScorpionAnimations;let t=o.ScorpionAnimations.fullscorpions[o.ScorpionAnimations.scorpions.green];super(new a.Frame([t[n.AniSt.idle]]));for(let e=0;e<this.actiontimeouts.length;e++)this.timeouts.push(this.actiontimeouts[e]),this.actiontimeouts[e].pause();this.actiontimeouts[h.stay].restart(),this.anims=t,this.pos.x=e.x,this.pos.y=e.y,this.gravity.add(this.normalgravity),this.speed=.075,this.hitbox={x:0,y:0,w:16,h:16},w.collisionpool.push(new T(this,i.npc,i.grid|i.player,s.block)),w.collisionpool.push(new F(i.interactable,i.player,s.interact,this,this.awarenessbounds,this.panic))}panic(e,t){return e.actiontimeouts[h.panic].getTimeoutTicks()>3e3&&(e.pos.x>t.pos.y?e.dir=c.left:e.dir=c.right,e.actiontimeouts[h.panic].restart(),e.gravity.add(e.jumpgravity)),!1}update(){super.update(),this.handleTriggers()}handleTriggers(){for(;this.triggers.length>0;){let e=this.triggers.pop()||{name:"notrigger"};switch(e.name){case"stay":"triggered"===e.state&&100*Math.random()<30&&(this.actiontimeouts[h.stay].pause(),this.actiontimeouts[h.wander].restart(),100*Math.random()<50?(this.flip.flipx=!0,this.dir=c.left):(this.flip.flipx=!1,this.dir=c.right));break;case"wander":switch(e.state){case"triggered":100*Math.random()<90&&(this.actiontimeouts[h.wander].pause(),this.actiontimeouts[h.stay].restart());break;case"active":this.actiontimeouts[h.panic].paused&&(this.movementvector.x=this.dir==c.left?-1:1)}break;case"panic":switch(e.state){case"triggered":case"paused":break;case"active":this.dir==c.left?this.movementvector.x=1:this.movementvector.x=-1,this.actiontimeouts[h.panic].getTimeoutTicks()>=200&&this.gravity.delete(this.jumpgravity),this.actiontimeouts[h.panic].getTimeoutTicks()>=500&&(this.actiontimeouts[h.panic].pause(),this.actiontimeouts[h.stay].restart())}}}}}class B{async start(){}static pool=[];constructor(){B.pool.push(this)}}!function(e){e[e.idle=0]="idle",e[e.pan=1]="pan",e[e.zoom=2]="zoom"}(x||(x={}));class U extends f{action=x.idle;actor;callback=()=>{};pan=[];constructor(){super(!0),this.actor=new r.Embodiment(new a.Frame([new a.Snap([new a.Image("_assets/blocking.png",{x:0,y:0,w:1,h:1},{x:0,y:0,w:1,h:1})])])),this.actor.myFrame.rprops.hidden=!0}refresh(){if(this.action!=x.idle&&this.action==x.pan)for(;this.actor.triggers.length>0;){let e=this.actor.triggers.pop()||{name:""};"pan"==e.name&&("active"==e.state&&(this.actor.pos.x=this.pan[0].x+this.actor.timeouts[0].getTimeoutTicks()/this.actor.timeouts[0].ms[0]*this.pan[1].x,this.actor.pos.y=this.pan[0].y+this.actor.timeouts[0].getTimeoutTicks()/this.actor.timeouts[0].ms[0]*this.pan[1].y),"triggered"==e.state&&(this.actor.timeouts=[],this.action=x.idle,this.callback()))}}panCamera(e,s,i,r=()=>{}){this.actor.pos.x=e.x,this.actor.pos.y=e.y,this.actor.timeouts=[new t.Timeout([i],"pan")],this.pan[0]=e,this.pan[1]={x:s.x-e.x,y:s.y-e.y},this.action=x.pan,this.callback=r}}class P extends B{bodies=[];cellbuild;player;ui=[];paused=!1;uielt;async start(){e.Info.gl.clearColor(0,0,0,1),t.Delta.refresh(),new m,new g,new w,new o.CharacterAnimations,await Promise.all(await d.loadAllExtInFolder("_assets/demon/",["png"])),this.paused=!0;let r=new U,n=new E(r.actor,{w:e.Info.gl.canvas.width,h:e.Info.gl.canvas.height},{x:0,y:0,w:2400,h:320});this.ui.push(r.actor),this.uielt=document.getElementById("instructions"),this.uielt.innerHTML="Attrapez la statuette",this.uielt.style.top="50px",this.uielt.style.fontSize="50px",this.cellbuild=await k.loadIni("_assets/demon/lvl01.ini");let l=v.blit(this.cellbuild,"level-layer"),h=new _(this.cellbuild.collisions,16,i.player|i.npc,s.block);w.collisionpool.push(h),this.putNPCs(this.cellbuild.npcs);let c=new A;return this.player=c,c.uielt=this.uielt,this.bodies.push(c),r.panCamera({x:680,y:200},{x:680,y:200},1e3,()=>{d.playSound("_assets/demon/roar.wav"),r.panCamera({x:680,y:200},{x:680,y:200},2e3,()=>{r.panCamera({x:680,y:200},{x:176,y:200},8e3,()=>{r.panCamera({x:176,y:200},{x:176,y:200},1e3,()=>{this.uielt.innerHTML="",n.actor=c,this.paused=!1})})})}),p.frm=new a.Frame([...l,...this.bodies.map(e=>e.myFrame)]),p.frm.camera=n,c.myCamera=p.frm.camera,p.frm.rprops.srcrect={x:0,y:0,w:e.Info.gl.canvas.width,h:e.Info.gl.canvas.height},p.frm.rprops.shaderID="reverser",new P}run(){t.Delta.refresh(),f.refresh(),this.paused?r.Alacrity.refreshsome(this.ui):r.Alacrity.refresh(),p.frm.camera.refresh(),r.Alacrity.resetallmovements()}putNPCs(e){let t=e.split("\n").map(e=>e.split(","));for(let e=0;e<t.length;e++)for(let s=0;s<t[e].length;s++)switch(Number(t[e][s])){case I.index:this.bodies.push(new I({x:16*s,y:16*e}));break;case R.index:this.bodies.push(new R({x:16*s,y:16*e}));break;case M.index:this.bodies.push(new M({x:16*s,y:16*e}));break;case C.index:this.bodies.push(new C({x:16*s,y:16*e}));break;case L.index:this.bodies.push(new L({x:16*s,y:16*e}));break;case D.index:this.bodies.push(new D({x:16*s,y:16*e}))}}}class z{static iM=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];static ortho(e,t,s,i,r,a){return new Float32Array([i,0,0,0,0,r,0,0,0,0,a,0,e,t,s,1])}static multiplyMatrices(e,t){let s=[t[0],t[1],t[2],t[3]],i=[t[4],t[5],t[6],t[7]],r=[t[8],t[9],t[10],t[11]],a=[t[12],t[13],t[14],t[15]],o=this.multiplyMatrixAndPoint(e,s),n=this.multiplyMatrixAndPoint(e,i),l=this.multiplyMatrixAndPoint(e,r),h=this.multiplyMatrixAndPoint(e,a);return new Float32Array([o[0],o[1],o[2],o[3],n[0],n[1],n[2],n[3],l[0],l[1],l[2],l[3],h[0],h[1],h[2],h[3]])}static multiplyMatrixAndPoint(e,t){let s=e[0],i=e[1],r=e[2],a=e[3],o=e[4],n=e[5],l=e[6],h=e[7],c=e[8],x=e[9],u=e[10],d=e[11],y=e[12],p=e[13],m=e[14],g=e[15],f=t[0],w=t[1],b=t[2],T=t[3];return[f*s+w*o+b*c+T*y,f*i+w*n+b*x+T*p,f*r+w*l+b*u+T*m,f*a+w*h+b*d+T*g]}static rotation(e,t){return this.multiplyMatrices(e,[Math.cos(t),-Math.sin(t),0,0,Math.sin(t),Math.cos(t),0,0,0,0,1,0,0,0,0,1])}static normalize(e,t,s){return e[0]=e[0]/t,e[5]=e[5]/s,e[12]=e[12]/t,e[13]=e[13]/s,e}static orthographic(e,t,s,i,r,a,o=new Float32Array(16)){return o[0]=2/(t-e),o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/(i-s),o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2/(r-a),o[11]=0,o[12]=(e+t)/(e-t),o[13]=(s+i)/(s-i),o[14]=(r+a)/(r-a),o[15]=1,o}static scale(e,t,s,i,r=new Float32Array(16)){return r[0]=t*e[0],r[1]=t*e[1],r[2]=t*e[2],r[3]=t*e[3],r[4]=s*e[4],r[5]=s*e[5],r[6]=s*e[6],r[7]=s*e[7],r[8]=i*e[8],r[9]=i*e[9],r[10]=i*e[10],r[11]=i*e[11],e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r}static translate(e,t,s,i,r=new Float32Array(16)){var a=e[0],o=e[1],n=e[2],l=e[3],h=e[4],c=e[5],x=e[6],u=e[7],d=e[8],y=e[9],p=e[10],m=e[11],g=e[12],f=e[13],w=e[14],b=e[15];return e!==r&&(r[0]=a,r[1]=o,r[2]=n,r[3]=l,r[4]=h,r[5]=c,r[6]=x,r[7]=u,r[8]=d,r[9]=y,r[10]=p,r[11]=m),r[12]=a*t+h*s+d*i+g,r[13]=o*t+c*s+y*i+f,r[14]=n*t+x*s+p*i+w,r[15]=l*t+u*s+m*i+b,r}}class N extends y{program;name="reverser";matrixLocation;textureMatrixLocation;texture;second=[()=>{}];first=[()=>{let e=y.gl,t=e.getAttribLocation(this.program,"aVertexPosition");e.enableVertexAttribArray(t),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0);let s=e.getAttribLocation(this.program,"texcoordLocation");e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),this.matrixLocation=e.getUniformLocation(this.program,"matrixLocation"),this.textureMatrixLocation=e.getUniformLocation(this.program,"textureMatrixLocation"),this.texture=e.getUniformLocation(this.program,"texture")}];passes=[(e,t)=>{let s=y.gl,i=new Float32Array([e.rprops.dstrect.w,0,0,0,0,e.rprops.dstrect.h,0,0,0,0,1,0,e.rprops.dstrect.x,e.rprops.dstrect.y,0,1]);if(i[0]*=2/t.w,i[5]*=-2/t.h,i[12]=i[12]*(2/t.w)-1,i[13]=-i[13]*(2/t.h)+1,s.uniformMatrix4fv(this.matrixLocation,!1,i),null!=this.textureMatrixLocation){let e=z.orthographic(-1,1,1,-1,-1,1);s.uniformMatrix4fv(this.textureMatrixLocation,!1,e)}}]}class X extends y{program;name="normal";matrixLocation;textureMatrixLocation;texture;second=[()=>{}];first=[()=>{let e=y.gl,t=e.getAttribLocation(this.program,"aVertexPosition");e.enableVertexAttribArray(t),e.vertexAttribPointer(t,2,e.FLOAT,!1,0,0);let s=e.getAttribLocation(this.program,"texcoordLocation");e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),this.matrixLocation=e.getUniformLocation(this.program,"matrixLocation"),this.textureMatrixLocation=e.getUniformLocation(this.program,"textureMatrixLocation")}];passes=[(e,t)=>{let s=y.gl,i=new Float32Array([e.rprops.dstrect.w,0,0,0,0,e.rprops.dstrect.h,0,0,0,0,1,0,e.rprops.dstrect.x,t.h-e.rprops.dstrect.y-e.rprops.dstrect.h,0,1]);if(0!=e.rprops.angle){let t=[];t[0]=Math.cos(-e.rprops.angle)*i[0],t[1]=-Math.sin(-e.rprops.angle)*i[0],t[3]=Math.sin(-e.rprops.angle)*i[5],t[4]=Math.cos(-e.rprops.angle)*i[5],i[0]=t[0],i[1]=t[1],i[4]=t[3],i[5]=t[4]}if(i[0]*=2/t.w,i[1]*=2/t.w,i[4]*=-2/t.h,i[5]*=-2/t.h,i[12]=i[12]*(2/t.w)-1,i[13]=-i[13]*(2/t.h)+1,s.uniformMatrix4fv(this.matrixLocation,!1,i),null!=this.textureMatrixLocation){let t=z.orthographic(-1,1,-1,1,-1,1);t=z.translate(t,0,1,0),e.rprops.flip.flipx&&e.rprops.flip.flipy||(e.rprops.flip.flipx?(t=z.orthographic(1,-1,-1,1,-1,1),t=z.translate(t,-1,1,0)):e.rprops.flip.flipy),s.uniformMatrix4fv(this.textureMatrixLocation,!1,t)}}]}class j extends y{static shaderts=[new X,new N];static async init(){await this.compileAllShadersFrom("shaders/")}static async compileAllShadersFrom(e){let t=[];await Promise.all(await d.loadAllExtInFolder(e,["frag","vert"])).then(e=>{e.map((e,s,i)=>{let r=e.split("/")[1].split(".")[0];for(let e=s;e<i.length;e++)r!=i[e].split("/")[1].split(".")[0]||t.includes(r)||t.push(r)})});for(let e=0;e<t.length;e++)y.shaders[t[e]]=(()=>{let s=y.compileShader(y.gl.VERTEX_SHADER,d.getText("shaders/"+t[e]+".vert")),i=y.compileShader(y.gl.FRAGMENT_SHADER,d.getText("shaders/"+t[e]+".frag")),r=y.createProgram(s,i);r||console.log("Shader creation unsuccessful:"+y.shaders[t[e]]);for(let s=0;s<this.shaderts.length;s++)if(this.shaderts[s].name==t[e]&&null!=r)return this.shaderts[s].program=r,this.shaderts[s];return this.shaderts[0]})();return t}}let O=!0;const q=()=>{H.run(),m.refresh(),g.refresh(),p.refresh(),O?requestAnimationFrame(G):requestAnimationFrame(q)};function G(){for(let e in m.keys)1===m.keys[e]&&(d.audioContext.resume(),document.getElementById("gobutton").style.display="none",O=!1);m.refresh(),g.refresh(),p.refresh(),O?requestAnimationFrame(G):requestAnimationFrame(q)}let H;new e.GL("133","250"),H=new P,(async()=>{await j.init(),d.initAudio(),await H.start()})().then(()=>{document.getElementById("gobutton").style.visibility="visible",q()});let Y=document.getElementById("gobutton").getBoundingClientRect();g.addButton("gobutton",{x:Y.x,y:Y.y,w:Y.width,h:500},()=>{d.audioContext.resume(),document.getElementById("gobutton").style.display="none",O=!1})})();